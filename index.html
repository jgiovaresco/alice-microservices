<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>Alice au pays des micro-services</title>

        <meta name="description" content="feedback talk on spliting a Monolith into micro-services">

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/bridge.css">

        <!-- Theme used for syntax highlighting of code -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- custom CSS for images and logos -->
        <link rel="stylesheet" href="css/custom.css">

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section>
                    <h1>Alice au pays des micro-services</h1>
                    <p style="margin-top: 150px">
                        <small>By Julien Giovaresco & Willy Malvault</small>
                    </p>
                </section>

                <section>
                    <section>
                        <img class="bridge-logo" src="images/logo/BRIDGE.png" alt="bridge logo" />
                        <h3>A central platform for points of sale management</h3>
                        <ul>
                            <li>Store Locator</li>
                            <li>Presence Management</li>
                            <li>Advertisement</li>
                            <li>more to come....</li>
                        </ul>
                    </section>

                    <section>
                        <h2>Some figures</h2>

                        <div class="logo-slim">
                            <img class="dim-logo" src="images/clients/dim.png" alt="dim logo" />
                            <img class="kerastase-logo" src="images/clients/kerastase.png" alt="kerastase logo" />
                            <img class="l-oreal-logo" src="images/clients/l-oreal.png" alt="l-oreal logo" />
                            <img class="millet-logo" src="images/clients/millet.png" alt="millet logo" />
                        </div>

                        <ul>
                            <li>200+ clients</li>
                            <li>515k+ shops</li>
                            <li>5M monthly unique visitors</li>
                            <li>15M daily visited pages</li>
                        </ul>

                        <div class="logo-fat">
                            <img class="darty-logo" src="images/clients/darty.png" alt="darty logo" />
                            <img class="ducati-logo" src="images/clients/ducati.png" alt="ducati logo" />
                            <img class="orange-logo" src="images/clients/orange.jpg" alt="orange logo" />
                            <img class="picard-logo" src="images/clients/picard.png" alt="picard logo" />
                        </div>
                    </section>

                    <section>
                        <h2>Context (V2 infrastructure)</h2>
                        <img class="rails-logo" src="images/logo/rails-1.svg" alt="rails logo" />
                        <img class="postgres-logo" src="images/logo/postgresql.svg" alt="postgresql logo" />
                        <ul>
                            <li>1st commit in July 2009</li>
                            <li>52 contributors</li>
                            <li>25,814 commits</li>
                            <li>1,047 releases</li>
                            <li>5,996 pull requests</li>
                            <li>734k lines</li>
                        </ul>
                    </section>

                    <section>
                        <img src="images/gifs/alice-crawling.gif" alt="alice question gif" />
                        <h2>Why going micro-services ?</h2>
                    </section>
                </section>

                <section>
                    <section>
                        <h1>Step 1</h1>
                        <h2>Build micro-services</h2>
                    </section>

                    <section data-transition="slide fade-out">
                        <img class="svg-slide" src="images/schemas/rest-page-0.svg" alt="rest 0" />
                    </section>

                    <section data-transition="slide fade-out">
                        <img class="svg-slide" src="images/schemas/rest-page-1.svg" alt="rest 1" />
                    </section>

                    <section data-transition="fade-in fade-out">
                        <img class="svg-slide" src="images/schemas/rest-page-2.svg" alt="rest 2" />
                    </section>

                    <section data-transition="none-in none-out">
                        <img class="svg-slide" src="images/schemas/rest-page-3.svg" alt="rest 3" />
                    </section>

                    <section data-transition="none-in none-out">
                        <img class="svg-slide" src="images/schemas/rest-page-4.svg" alt="rest 4" />
                    </section>

                    <section data-transition="none-in fade-out">
                        <img class="svg-slide" src="images/schemas/rest-page-5.svg" alt="rest 5" />
                    </section>

                    <section>
                        <h2>How to split services ?</h2>
                        <div class="fragment">
                            <blockquote>« Go as micro as possible ! »</blockquote>
                            <img width="450" src="images/gifs/alice-going-micro.gif" alt="alice late gif" />
                        </div>
                    </section>

                    <section data-transition="slide fade-out">
                        <img class="svg-slide" src="images/schemas/spliting-page-1.svg" alt="spliting 1" />
                    </section>

                    <section data-transition="slide fade-out">
                        <img class="svg-slide" src="images/schemas/spliting-page-2.svg" alt="spliting 2" />
                    </section>

                    <section data-transition="slide fade-out">
                        <img class="svg-slide" src="images/schemas/spliting-page-3.svg" alt="spliting 3" />
                    </section>

                    <section data-transition="slide fade-out">
                        <img class="svg-slide" src="images/schemas/spliting-page-4.svg" alt="spliting 4" />
                    </section>

                    <section data-transition="slide fade-out">
                        <img class="svg-slide" src="images/schemas/spliting-page-5.svg" alt="spliting 5" />
                    </section>

                    <section>
                        <h2>Want to Share some Library ?</h2>
                        <span>(Authentication, DB, Access control, ...)</span>

                        <div class="fragment">
                            <img width="450" src="images/gifs/i-am-fine.gif" alt="alice late gif" />
                            <br />
                            <span>But do <strong>micro libraries</strong> (one per concern) and keep <strong>all your services up to date !</strong></span>
                        </div>
                    </section>

                    <section>
                        <h2>How about Bridge ?</h2>
                        <img width="450" src="images/gifs/alice-bridge-team.gif" alt="alice bridge gif" />
                    </section>

                    <section>
                        <img class="svg-slide" src="images/schemas/bridge-overview.svg" alt="spliting 5" />
                    </section>
                </section>

                <section>
                    <section>
                        <h1>Step 2</h1>
                        <h2>Assembling blocks</h2>
                    </section>

                    <section data-transition="fade-in fade-out">
                        <img class="svg-slide" src="images/schemas/assembling-page-0.svg" alt="assembling 0" />
                    </section>

                    <section data-transition="fade-in fade-out">
                        <img class="svg-slide" src="images/schemas/assembling-page-1.svg" alt="assembling 1" />
                    </section>

                    <section data-transition="fade-in fade-out">
                        <img class="svg-slide" src="images/schemas/assembling-page-2.svg" alt="assembling 2" />
                    </section>

                    <section data-transition="fade-in fade-out">
                        <img src="images/gifs/alice-falling.gif" alt="falling alice" />
                    </section>

                    <section data-transition="fade-in fade-out">
                        <img class="svg-slide" src="images/schemas/assembling-page-3.svg" alt="assembling 2" />
                    </section>

                    <section>
                        <h2>How to deploy ?</h2>
                        <ul>
                            <li>Produce a big YAML</li>
                            <li>Give it to Kubernetes</li>
                        </ul>
                        <img class="eating-alice" src="images/gifs/alice-eating.gif" alt="eating alice" />
                    </section>

                    <section>
                        <h2>How to produce this yaml ?</h2>
                        <ul>
                            <li>Meta-project ensure consistency</li>
                            <li>Jenkins pipelines</li>
                        </ul>
                        <img class="alice-cards" src="images/gifs/alice-cards.gif" alt="alice cards gif" />
                    </section>
                </section>

                <section>
                    <section>
                        <h1>Step 3</h1>
                        <h2>Share data between services</h2>
                    </section>

                    <section>
                        <h2>Your services needs to share data</h2>
                        <img class="eating-alice" style="height: 300px; width: auto;" src="images/gifs/sharing-tea.gif" alt="sharing tea gif" />
                    </section>

                    <section>
                        <img class="svg-slide" src="images/schemas/data-synchro.svg" alt="data-synchro 0" />
                    </section>

                    <section>
                        <img class="svg-slide" style="height: 250px;" src="images/schemas/copy-vs-no-copy.svg" alt="copy vs no copy" />
                        <div class="fragment">
                            <h5>Two scenarios for comparison</h5>
                            <ol>
                                <li>Create a location and publish</li>
                                <li>Force publication of existing location</li>
                            </ol>
                        </div>
                    </section>

                    <section>
                        <img class="svg-slide" src="images/schemas/data-copy-crud.svg" alt="data-copy-crud" />
                    </section>

                    <section>
                        <img class="svg-slide" src="images/schemas/no-copy-crud.svg" alt="no-copy-crud" />
                    </section>

                    <section>
                        <img class="svg-slide" src="images/schemas/data-copy-request.svg" alt="data-copy-request" />
                    </section>

                    <section>
                        <img class="svg-slide" src="images/schemas/no-copy-request.svg" alt="no-copy-request" />
                    </section>

                    <section>
                        <h2>Theoretical results</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th></th>
                                    <th>Data copy</th>
                                    <th>No copy</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>CRUD</td>
                                    <td>5</td>
                                    <td>6</td>
                                </tr>
                                <tr>
                                    <td>Request</td>
                                    <td>3</td>
                                    <td>5</td>
                                </tr>
                                <tr>
                                    <td>Runtime</td>
                                    <td>indepent</td>
                                    <td>dependent</td>
                                </tr>
                                <tr class="fragment">
                                    <td>Data Synchro</td>
                                    <td>Hell or <a href="http://milinda.pathirage.org/kappa-architecture.com/">Kappa</a></td>
                                    <td>No (GraphQL)</td>
                                </tr>
                            </tbody>
                        </table>
                    </section>

                    <section>
                        <h2>So what should we choose ?</h2>
                        <img height="350" src="images/gifs/alice-confused.gif" alt="rabbit" />
                        <div class="fragment">
                            <span>We can tell you what you should not do : decentralizing the state (i.e. CRUD of the data)</span>
                        </div>
                    </section>

                    <section>
                        <h2>Beware ! don't decentralize the state of your services !</h2>
                        <ul>
                            <li>Boucle geocoding avec correction addresse pas utilisateur</li>
                            <li>Boucle all locations avec URL website corrigée</li>
                        </ul>
                    </section>

                    <section>
                        <a href="https://api-documentation.leadformance.com/messageViz/index.html">
                            <img class="message-viz" src="images/messageviz.png" alt="message visualization" />
                        </a>
                    </section>
                </section>

                <section>
                    <h2>Various things to mention</h2>
                    <ul>
                        <li>Where to put the cache ?</li>
                        <li>Need development stack (evrything in local is not enough)</li>
                        <li>messaging meta-data, correlation ID, errors, parent emmiter</li>
                    </ul>
                </section>

                <section>
                    <h2>The slide to remember</h2>
                    <ul>
                        <li class="fragment">Micro services work</li>
                        <li class="fragment">Go as micro as you can</li>
                        <li class="fragment">Think about you data</li>
                    </ul>
                </section>

                <section data-background="gifs/thank-you.gif" style="color: black;">
                    <h2>Thank you !</h2>
                </section>
            </div>
        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>
            // More info about config & dependencies:
            // - https://github.com/hakimel/reveal.js#configuration
            // - https://github.com/hakimel/reveal.js#dependencies
            Reveal.initialize({
                dependencies: [
                { src: 'plugin/markdown/marked.js' },
                { src: 'plugin/markdown/markdown.js' },
                { src: 'plugin/notes/notes.js', async: true },
                { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
                ]
            });
        </script>
    </body>
</html>
