<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>Alice au pays des micro-services</title>

        <meta name="description" content="feedback talk on spliting a Monolith into micro-services">

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/bridge.css">

        <!-- Theme used for syntax highlighting of code -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- custom CSS for images and logos -->
        <link rel="stylesheet" href="css/custom.css">

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section>
                    <h1>Alice au pays des micro-services</h1>
                    <p style="margin-top: 150px">
                        <small>By Julien Giovaresco and Willy Malvault</small>
                    </p>
                    <img src="images/logo/SoLocal_w.png" height="100" alt="bridge logo" />
                </section>

                <section>
                    <section>
                        <img src="images/solocal-bridge-white.png" alt="bridge logo" />
                    </section>

                    <section>
                        <img class="svg-slide" src="images/schemas/bridge-platform.svg" alt="BRIDGE platform" />
                    </section>

                    <section>
                        <h2>Some figures</h2>

                        <div class="logo-slim">
                            <img class="dim-logo" src="images/clients/dim.png" alt="dim logo" />
                            <img class="kerastase-logo" src="images/clients/kerastase.png" alt="kerastase logo" />
                            <img class="diesel-logo" src="images/clients/diesel.png" alt="diesel logo" />
                            <img class="millet-logo" src="images/clients/millet.png" alt="millet logo" />
                        </div>

                        <ul>
                            <li>250+ clients</li>
                            <li>515k+ shops</li>
                            <li>5M monthly unique visitors</li>
                            <li>15M daily visited pages</li>
                        </ul>

                        <div class="logo-fat">
                            <img class="darty-logo" src="images/clients/darty.png" alt="darty logo" />
                            <img class="ducati-logo" src="images/clients/ducati.png" alt="ducati logo" />
                            <img class="orange-logo" src="images/clients/orange.jpg" alt="orange logo" />
                            <img class="picard-logo" src="images/clients/picard.png" alt="picard logo" />
                        </div>
                    </section>

                    <section>
                        <h2>Legacy</h2>
                        <div class="legacy">
                            <img class="rails-logo" src="images/logo/rails-1.svg" alt="rails logo" />
                            <ul>
                                <li>July 2009</li>
                                <li>1 GIT repository</li>
                                <li>8 developers</li>
                                <li>25,814 commits</li>
                                <li>1,047 releases</li>
                            </ul>
                            <img class="postgres-logo" src="images/logo/postgresql.svg" alt="postgresql logo" />
                        </div>
                    </section>

                    <section>
                        <img class="svg-slide" src="images/schemas/why-micro-services.svg" alt="why going micro service ?" />
                    </section>

                    <section>
                        <h3>Ready to trip down the rabbit hole ?</h3>
                        <img class="svg-slide" src="images/gifs/alice-tripping-down.gif" alt="Alice tripping down the hole" />
                    </section>

                    <!-- <section> -->
                    <!--     <h2>Why going micro-services ?</h2> -->
                    <!--     <img src="images/gifs/alice-crawling.gif" height="350" alt="alice question gif" /> -->
                    <!-- </section> -->
                </section>

                <section>
                    <section>
                        <h1>1</h1>
                        <h2>Architecture & Design</h2>
                    </section>

                    <section data-transition=" fade-in none-out">
                        <img class="svg-slide" src="images/schemas/bridge-overview-0.svg" alt="bridge overview" />
                    </section>

                    <section data-transition=" none-in none-out">
                        <img class="svg-slide" src="images/schemas/bridge-overview-1.svg" alt="bridge overview" />
                    </section>

                    <section data-transition=" none-in none-out">
                        <img class="svg-slide" src="images/schemas/bridge-overview-2.svg" alt="bridge overview" />
                    </section>

                    <section data-transition=" none-in none-out">
                        <div>
                            <h2>Leitmotiv</h2>
                            <blockquote>« Go as micro as possible! »</blockquote>
                            <img width="450" src="images/gifs/alice-going-micro.gif" alt="alice late gif" />
                            <blockquote>simple / modular / easy / tests / refacto</blockquote>
                        </div>
                    </section>

                    <section data-transition=" none-in none-out">
                        <img class="svg-slide" src="images/schemas/bridge-overview-3.svg" alt="bridge overview" />
                    </section>

                    <section data-transition=" none-in none-out">
                        <img class="svg-slide" src="images/schemas/bridge-overview-4.svg" alt="bridge overview" />
                    </section>

                    <section data-transition=" none-in none-out">
                        <img class="svg-slide" src="images/schemas/bridge-overview-5.svg" alt="bridge overview" />
                    </section>

                    <section data-transition=" none-in none-out">
                        <img class="svg-slide" src="images/schemas/bridge-overview-6.svg" alt="bridge overview" />
                    </section>

                    <section data-transition=" none-in fade-out">
                        <img class="svg-slide" src="images/schemas/bridge-overview-7.svg" alt="bridge overview" />
                    </section>

                    <!-- <section> -->
                    <!--     <h2>Leitmotiv</h2> -->
                    <!--     <blockquote>« Go as micro as possible! »</blockquote> -->
                    <!--     <img width="450" src="images/gifs/alice-going-micro.gif" alt="alice late gif" /> -->
                    <!-- </section> -->

                    <section>
                        <h2>Want to Share some Library ?</h2>
                        <span>(Authentication, DB, Access control, ...)</span>

                        <div class="fragment">
                            <img width="450" src="images/gifs/woah-no.gif" alt="whoah no" />
                            <br />
                            <span>Try to avoid! But if you do,  do <strong>micro libraries</strong> and keep <strong>all your services up to date!</strong></span>
                        </div>
                    </section>

                    <section>
                        <h2>Promising evolutions</h2>
                        <ul>
                            <li>Setup an API gateway</li>
                            <li>Use a storage API</li>
                        </ul>
                        <br />
                        <img height="300" src="images/gifs/alice-promising.gif" alt="alice promising world gif" />
                    </section>
                </section>

                <section>
                    <section>
                        <h1>2</h1>
                        <h2>Assembling blocks</h2>
                    </section>

                    <section>
                        <h2>Microservices caveats</h2>
                        <ul>
                            <li>Configuration on multiple spots</li>
                            <li>Deployment agility</li>
                        </ul>
                    </section>

                    <section>
                        <h2>Kubernetes</h2>
                        <div>
                            <div class="k8s">
                                <img class="k8s-logo" src="images/logo/kubernets.svg" alt="kubernetes logo" />
                                <img src="images/gifs/alice-orchestrator.gif" alt="orchestrator" />
                            </div>
                            <ul>
                                <li>Containers orchestrator</li>
                                <li>Started by Google</li>
                                <li>Run and manage containers</li>
                                <li>Provides container grouping, load balancing, auto-healing, scaling features</li>
                            </ul>
                        </div>
                    </section>

                    <section>
                        <h2>Our backbone</h2>
                        <img src="images/gifs/alice-worship.gif" height="300" alt="alice worship" />
                        <ul>
                            <li>Internal DNS</li>
                            <li>Centralized configuration</li>
                            <li>The Kubernetes way of managing outages</li>
                            <li>Easy-peasy deploy</li>
                        </ul>
                    </section>

                    <section>
                        <h2>How to deploy ?</h2>
                        <ul class="fragment">
                            <li>Produce a big YAML</li>
                        </ul>
                        <div class="fragment">
                            <ul>
                                <li>Give it to Kubernetes</li>
                            </ul>
                            <img class="eating-alice" src="images/gifs/alice-eating.gif" alt="eating alice"/>
                        </div>
                    </section>

                    <section>
                        <h2>How to produce this yaml ?</h2>
                        <div class="fragment">
                            <ul>
                                <li>Meta-project ensure consistency</li>
                                <li>Jenkins pipelines</li>
                            </ul>
                            <img class="alice-cards" height="300" src="images/gifs/alice-cards.gif" alt="alice cards gif" />
                        </div>
                    </section>

                    <section>
                        <h2>Release</h2>
                        <ul class="fragment">
                            <li>Weekly</li>
                            <li>More Jenkins pipelines</li>
                            <li>Our process
                                <ul>
                                    <li>Update version in meta-project</li>
                                    <li>Tests</li>
                                    <li>Tag</li>
                                </ul>
                            </li>
                        </ul>
                    </section>
                </section>

                <section>
                    <section>
                        <h1>3</h1>
                        <h2>Share data between services</h2>
                    </section>

                    <section>
                        <h2>Your services needs to share data</h2>
                        <img class="eating-alice" style="height: 300px; width: auto;" src="images/gifs/sharing-tea.gif" alt="sharing tea gif" />
                    </section>

                    <section>
                        <img class="svg-slide" src="images/schemas/data-synchro.svg" alt="data-synchro" />
                    </section>

                    <section>
                        <h2>The different path</h2>
                        <img class="svg-slide" src="images/gifs/alice-choose-path.gif" alt="alice choose path" />
                        <ol>
                            <li class="fragment">One single shared DB (strong coupling)</li>
                            <li class="fragment">Ask data when needed (slow read)</li>
                            <li class="fragment"><strong>Full data copy (NoSQL way : fast read)</strong></li>
                        </ol>
                    </section>

                    <section>
                        <img class="svg-slide" src="images/schemas/data-copy-crud.svg" alt="data-copy-crud" />
                    </section>

                    <section>
                        <img class="svg-slide" src="images/schemas/data-copy-request.svg" alt="data-copy-request" />
                    </section>

                    <section>
                        <img class="svg-slide" src="images/schemas/product-copy-synchro.svg" alt="product-copy-synchro" />
                    </section>

                    <section data-transition="fade-in none-out">
                        <img class="svg-slide" src="images/schemas/data-synchro-hell-0.svg" alt="data synchro hell" />
                    </section>

                    <section data-transition="none-in none-out">
                        <img class="svg-slide" src="images/schemas/data-synchro-hell-1.svg" alt="data synchro hell" />
                    </section>

                    <section data-transition="none-in none-out">
                        <img class="svg-slide" src="images/schemas/data-synchro-hell-2.svg" alt="data synchro hell" />
                    </section>

                    <section data-transition="none-in none-out">
                        <img class="svg-slide" src="images/schemas/data-synchro-hell-3.svg" alt="data synchro hell" />
                    </section>

                    <section data-transition="none-in none-out">
                        <img class="svg-slide" src="images/schemas/data-synchro-hell-4.svg" alt="data synchro hell" />
                    </section>

                    <section data-transition="none-in none-out">
                        <img class="svg-slide" src="images/schemas/data-synchro-hell-5.svg" alt="data synchro hell" />
                    </section>

                    <section data-transition="none-in fade-out">
                        <img class="svg-slide" src="images/schemas/data-synchro-hell-6.svg" alt="data synchro hell" />
                    </section>

                    <section>
                        <blockquote>Data Synchro complexity grows along with service decentralization</blockquote>
                        <img height="350" src="images/gifs/gone-mad.gif" alt="gone mad" />
                    </section>

                    <section>
                        <h2>Further solutions</h2>
                        <ul>
                            <li class="fragment"><a href="http://milinda.pathirage.org/kappa-architecture.com/">Kappa Architecture</a></li>
                            <li class="fragment">No copy at all + cache + GraphQL</li>
                        </ul>
                    </section>
                    <!-- <section> -->
                    <!--     <a href="https://api-documentation.leadformance.com/messageViz/index.html"> -->
                    <!--         <img class="message-viz" src="images/messageviz.png" alt="message visualization" /> -->
                    <!--     </a> -->
                    <!-- </section> -->
                </section>

                <section>
                    <section>
                        <h1>4</h1>
                        <h2>Few more advices</h2>
                    </section>

                    <section>
                        <h2>The caching misery</h2>
                        <div class="dev-stacks">
                            <img src="images/gifs/alice-hiding.gif" alt="alice hiding" />
                            <ul>
                                <li>Inside K8S cluster</li>
                                <li>Outside K8S cluster</li>
                                <li>?</li>
                            </ul>
                        </div>
                    </section>

                    <section>
                        <h2>You need development stacks</h2>
                        <div class="dev-stacks">
                            <img src="images/gifs/alice-friends.gif" alt="alice friends" />
                            <ul>
                                <li>Dedicate cluster</li>
                                <li>External services</li>
                                <li>Internal services</li>
                            </ul>
                        </div>
                    </section>

                    <section>
                        <h2>The big messaging bugs (meta-data mandatory)</h2>
                        <div class="messaging-bugs">
                            <img src="images/gifs/alice-maze.gif" alt="alice maze" />
                            <ul>
                                <li>Monitoring</li>
                                <li>User</li>
                                <li>Correlation id</li>
                                <li>...</li>
                            </ul>
                        </div>
                    </section>

                    <section>
                        <h2>Use explicit contract</h2>
                        <div class="messaging-bugs">
                            <img src="images/gifs/what-it-is.gif" width="400" alt="alice hiding" />
                            <ul>
                                <li>Avro, Protobuf, ...</li>
                                <li>GraphQL</li>
                            </ul>
                        </div>
                    </section>
                </section>

                <section>
                    <h2>The slide to remember</h2>
                    <ul>
                        <li class="fragment">We did it! So can you!</li>
                        <li class="fragment">We don't regret it (for now)</li>
                        <li class="fragment">Go as micro as you can</li>
                        <li class="fragment">Use an orchestrator</li>
                        <li class="fragment">Data distribution is more complex than you think!</li>
                    </ul>
                </section>

                <section data-background="gifs/thank-you.gif" style="color: black;">
                    <h2>Thank you!</h2>
                </section>
            </div>
        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>
            // More info about config & dependencies:
            // - https://github.com/hakimel/reveal.js#configuration
            // - https://github.com/hakimel/reveal.js#dependencies
            Reveal.initialize({
                dependencies: [
                { src: 'plugin/markdown/marked.js' },
                { src: 'plugin/markdown/markdown.js' },
                { src: 'plugin/notes/notes.js', async: true },
                { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
                ]
            });
        </script>
    </body>
</html>
